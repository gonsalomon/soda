from __future__ import annotations

from soda.sampler.sample import Sample
from soda.sampler.sample_schema import SampleColumn, SampleSchema


class InMemorySample(Sample):
    def __init__(self, rows: dict, schema: list[str], data_source):
        self.rows = rows
        self.schema = SampleSchema(columns=SampleColumn.create_simple_str_sample_columns(schema))
        self.data_source = data_source

    def get_rows(self) -> tuple[tuple]:
        return self.rows

    def get_schema(self) -> SampleSchema:
        return self.schema
